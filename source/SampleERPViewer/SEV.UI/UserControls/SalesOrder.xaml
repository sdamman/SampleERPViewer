<UserControl x:Class="SEV.UI.UserControls.SalesOrder"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:conv="clr-namespace:SEV.UI.Converters"
             xmlns:theme="clr-namespace:CustomT.UI"
             xmlns:uc="clr-namespace:SEV.UI.UserControls"
             mc:Ignorable="d" d:Background="White"
             d:DesignHeight="450" d:DesignWidth="800">

  <UserControl.Resources>
    <BooleanToVisibilityConverter x:Key="B2VC"/>
    <conv:CurrencyDisplayConverter x:Key="cDC"/>
    <Style TargetType="{x:Type TextBlock}" BasedOn="{StaticResource bodyCopy}">
      <Setter Property="Margin" Value="4,1"/>
      <Setter Property="VerticalAlignment" Value="Bottom"/>
    </Style>
    <Style TargetType="{x:Type TextBox}" BasedOn="{StaticResource TextBoxStyle}">
      <Setter Property="VerticalContentAlignment" Value="Center"/>
    </Style>
  </UserControl.Resources>

  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
    </Grid.RowDefinitions>
    <Grid Grid.Row="0" Margin="10">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>
      <StackPanel Grid.Column="0" Orientation="Horizontal">
        <TextBlock Text="Sales Order:" VerticalAlignment="Center"/>
        <TextBox Height="25" MinWidth="110"
                   VerticalContentAlignment="Center"
                   Text="{Binding SalesOrderNumber, Mode=TwoWay,
                    UpdateSourceTrigger=PropertyChanged}"
                   Style="{DynamicResource TextBoxSearch}"
                   d:Style="{StaticResource TextBoxSearch}"
                   AcceptsReturn="False"
                   AcceptsTab="False">
          <TextBox.InputBindings>
            <KeyBinding Command="{Binding CommandGetSalesOrder}" Key="Return"
                          CommandParameter="{Binding SalesOrderNumber}"/>
          </TextBox.InputBindings>
          <TextBox.ToolTip>
            <Border Background="{theme:ThemeResource ResourceKey=MaxContrast}">
              <TextBlock Text="No wildcards needed." Margin="10"/>
            </Border>
          </TextBox.ToolTip>
        </TextBox>
        <Button Style="{DynamicResource ButtonSearch}"
                  Height="25" Margin="-1,0,0,0"
                  MinWidth="22"
                  Command="{Binding CommandGetSalesOrder}" 
                  CommandParameter="{Binding SalesOrderNumber}"
                  Padding="3"
                  IsEnabled="{Binding AreButtonsEnabled}"
                  IsDefault="True">
        </Button>
      </StackPanel>
      <StackPanel Grid.Column="1" Orientation="Horizontal" 
                  HorizontalAlignment="Right"
                  Visibility="{Binding IsVisible, Converter={StaticResource B2VC}}">
        <TextBlock Text="Status:"/>
        <TextBlock Text="{Binding Status, FallbackValue='CANCELLED'}"
                   Style="{StaticResource emphasisSmall}"/>
      </StackPanel>
    </Grid>
    
    <StackPanel Grid.Row="1" Margin="10"
                Visibility="{Binding IsVisible, Converter={StaticResource B2VC}}">
      <Border Background="{theme:ThemeResource ResourceKey=MouseOverBackground}">
      <StackPanel Orientation="Horizontal" >
        <TextBlock Text="Customer: " Style="{StaticResource emphasis}"
                   Foreground="{StaticResource brushMainThemeBlue}"/>
        <TextBlock Text="{Binding Company, FallbackValue='Crops R Us'}"
                   Style="{StaticResource emphasisSmall}"
                   Foreground="{StaticResource brushMainThemeBlue}"/>
        <TextBlock Text="Customer Number:" Margin="40,0,0,0"
                   Style="{StaticResource emphasisSmall}"
Foreground="{StaticResource brushMainThemeBlue}"/>
        <TextBlock Text="{Binding CustomerNumber, FallbackValue='012345'}"
                   Style="{StaticResource emphasisSmall}"
                   Foreground="{StaticResource brushMainThemeBlue}"/>
        </StackPanel>
      </Border>
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="1.1*"/>
          <ColumnDefinition Width="1*"/>
          <ColumnDefinition Width="1.5*"/>
        </Grid.ColumnDefinitions>
        <StackPanel Grid.Column="0">
          <TextBlock Text="{Binding SoldToAddress, FallbackValue='123 Big Jimmy Street'}"/>
          <StackPanel Orientation="Horizontal" >
            <TextBlock Text="{Binding SoldToCity, FallbackValue='BarkinVille'}"/>
            <TextBlock Text=", " Margin="-1,1,0,1"/>
            <TextBlock Text="{Binding SoldToState, FallbackValue='AR'}"/>
          </StackPanel>
          <StackPanel Orientation="Horizontal" >
            <TextBlock Text="{Binding SoldToCountry, FallbackValue='USA'}"/>
            <TextBlock Text="{Binding SoldToPostalCode, FallbackValue='34215'}"
                       Margin="15,0,0,0"/>
          </StackPanel>
        </StackPanel>
        <StackPanel Grid.Column="1">
          <StackPanel Orientation="Horizontal" >
            <TextBlock Text="Serial Number:"/>
            <TextBlock Text="{Binding SerialNumber, FallbackValue='P25001'}"/>
          </StackPanel>
          <StackPanel Orientation="Horizontal" >
            <TextBlock Text="Model:"/>
            <TextBlock Text="{Binding Model, FallbackValue='PowerPlant'}"/>
          </StackPanel>
          <StackPanel Orientation="Horizontal" >
            <TextBlock Text="Due Date:"/>
            <TextBlock Text="{Binding DueDateDisplay, FallbackValue='2025-02-01'}"/>
          </StackPanel>
        </StackPanel>
        <StackPanel Grid.Column="2">
            <TextBlock Text="Memo:"/>
            <TextBlock Text="{Binding Memo1, FallbackValue='BarkinVille Rules!'}"/>
        </StackPanel>
      </Grid>
    </StackPanel>

    <Grid Grid.Row="2"
          Visibility="{Binding IsVisible, Converter={StaticResource B2VC}}">
      <Grid Margin="20,0">
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Border Background="{theme:ThemeResource ResourceKey=MouseOverBackground}"
                Margin="-10,0,-5,0"/>
        <StackPanel Orientation="Horizontal" Grid.Row="0">
          <TextBlock Text="Items" Margin="-5,2,0,0"
               FontFamily="Segoe UI Semibold" 
               FontSize="20"
               Foreground="{StaticResource brushMainThemeBlue}"
               d:Foreground="{StaticResource brushMainThemeBlue}"/>
          <Button Style="{DynamicResource ButtonCopy}" 
              Height="25" Margin="4,0,4,-5"
              Command="{Binding CommandCopySalesOrder}"/>
        </StackPanel>
        <uc:CurrentDate HorizontalAlignment="Right" VerticalAlignment="Bottom"/>

        <Border Grid.Row="1" BorderBrush="{theme:ThemeResource ResourceKey=MaxContrast}"
            d:BorderBrush="Black" BorderThickness="0,0,0,1">
          <Grid Margin="0,0,18,0">
            <Grid.Resources>
              <Style TargetType="{x:Type TextBlock}" BasedOn="{StaticResource bodyCopy}">
                <Setter Property="Foreground" Value="{theme:ThemeResource ResourceKey=Complement}"/>
              </Style>
            </Grid.Resources>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="1*"/>
              <ColumnDefinition Width="2*"/>
              <ColumnDefinition Width="0.8*"/>
              <ColumnDefinition Width="6.2*"/>
              <ColumnDefinition Width="1*"/>
              <ColumnDefinition Width="1*"/>
              <ColumnDefinition Width="2*"/>
              <ColumnDefinition Width="7*"/>
            </Grid.ColumnDefinitions>
            <TextBlock Grid.Column="0" Text="Item"/>
            <TextBlock Grid.Column="1" Text="Part Number" Margin="3,0"/>
            <TextBlock Grid.Column="2" Text="Rev"/>
            <TextBlock Grid.Column="3" Text="Description"/>
            <TextBlock Grid.Column="4" Text="QTY"/>
            <TextBlock Grid.Column="5" Text="UOM"/>
            <TextBlock Grid.Column="6" Text="Unit Price"/>
            <TextBlock Grid.Column="7" Text="Memo"/>
          </Grid>
        </Border>
        
        <ScrollViewer Grid.Row="2" Margin="0,0,0,10">
          <ItemsControl ItemsSource="{Binding Items, FallbackValue='1'}"
                    AlternationCount="2">
            <ItemsControl.ItemTemplate>
              <DataTemplate>
                <DataTemplate.Resources>
                  <Style TargetType="{x:Type TextBlock}" BasedOn="{StaticResource bodyCopy}"/>
                </DataTemplate.Resources>

                <Grid x:Name="content">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="1*"/>
                    <ColumnDefinition Width="2*"/>
                    <ColumnDefinition Width="0.8*"/>
                    <ColumnDefinition Width="6.2*"/>
                    <ColumnDefinition Width="1*"/>
                    <ColumnDefinition Width="1*"/>
                    <ColumnDefinition Width="2*"/>
                    <ColumnDefinition Width="7*"/>
                  </Grid.ColumnDefinitions>
                  <TextBlock Grid.Column="0" Text="{Binding SequenceNumber, FallbackValue='001'}"/>
                  <Expander Grid.Column="1"
                          Style="{StaticResource ExpanderButton}"
                          Header="{Binding PartNumber, FallbackValue='3031278A'}"
                          Margin="1">
                    <uc:PartNumberBox Tag="{Binding PartNumber}"/>
                  </Expander>
                  <TextBlock Grid.Column="2" Text="{Binding Revision, FallbackValue='000'}"/>
                  <TextBlock Grid.Column="3" Text="{Binding Description, FallbackValue='DESCRIPTION\,LONG\,CHARACTERS'}"/>
                  <TextBlock Grid.Column="4" Text="{Binding Quantity, FallbackValue='0.00'}"/>
                  <TextBlock Grid.Column="5" Text="{Binding UnitOfMeasure, FallbackValue='EA'}"/>
                  <TextBlock Grid.Column="6" Text="{Binding UnitPrice, 
              Converter={StaticResource cDC}, FallbackValue='$345.67'}"/>
                  <TextBlock Grid.Column="7" Text="{Binding ItemMemo, 
                  FallbackValue='Stuff Goes Here'}"/>
                </Grid>
                <DataTemplate.Triggers>
                  <Trigger Property="ItemsControl.AlternationIndex"
										 Value="1">
                    <Setter TargetName="content" 
											Property="Background"
											Value="{theme:ThemeResource ResourceKey=MinContrast}"/>
                  </Trigger>
                </DataTemplate.Triggers>
              </DataTemplate>
            </ItemsControl.ItemTemplate>
          </ItemsControl>
        </ScrollViewer>
      </Grid>
    </Grid>
  </Grid>
</UserControl>
